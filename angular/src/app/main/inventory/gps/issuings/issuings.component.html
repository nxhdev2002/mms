<div id="container" class="mt-2" [busyIf]="isLoading">
    <div class="ui-g-12">
        <fieldset class="fieldset-border grid-parent">
            <div class="ui-g-12">
                <div class="ui-g-12">
                    <h6 class="card-header">
                         {{ l(' Gps Issuing ') }}
                    </h6>
                </div>
                <div class="prod-cont">
                    <div class="ui-g-12">
                        <div class="form-group m-form__group align-items-center">
                            <div class="input-group">
                                <div class="input-search">
                                    <input
                                        [(ngModel)]="documentNo"
                                        name="documentNo"
                                        class="form-control"
                                        [placeholder]="l('Document No')"
                                        type="text"
                                        (keyup.enter)="searchDatas()"
                                    />
                                </div>
                                <div class="input-search">
                                    <input type="text" placeholder="Document Date" [(ngModel)]="documentDate"
                                        name="documentDate" class="form-control" bsDatepicker #dd="bsDatepicker"
                                        placement="bottom left"
                                        [bsConfig]="{ dateInputFormat: 'DD/MM/YYYY' ,isAnimated: true, selectFromOtherMonth:true, showClearButton: true, showTodayButton: true, todayPosition:'right',     }" />
                                    <i class="fa fa-calendar-alt" (click)="dd.toggle()"></i>
                                </div>
                                <div class="input-search">
                                    <input
                                        [(ngModel)]="shop"
                                        name="shop"
                                        class="form-control"
                                        [placeholder]="l('Shop')"
                                        type="text"
                                        (keyup.enter)="searchDatas()"
                                    />
                                </div>
                                <div class="input-search">
                                    <input
                                        [(ngModel)]="team"
                                        name="team"
                                        class="form-control"
                                        [placeholder]="l('Team')"
                                        type="text"
                                        (keyup.enter)="searchDatas()"
                                    />
                                </div>
                                <div class="input-search">
                                    <input
                                        [(ngModel)]="costCenter"
                                        name="costCenter"
                                        class="form-control"
                                        [placeholder]="l('Cost Center')"
                                        type="text"
                                        (keyup.enter)="searchDatas()"
                                    />
                                </div>
                                <div class="input-search">
                                    <input
                                        [(ngModel)]="partNo"
                                        name="partNo"
                                        class="form-control"
                                        [placeholder]="l('Part No')"
                                        type="text"
                                        (keyup.enter)="searchDatas()"
                                    />
                                </div>
                                <div class="input-search">
                                    <input
                                        [(ngModel)]="lotNo"
                                        name="lotNo"
                                        class="form-control"
                                        [placeholder]="l('Lot No')"
                                        type="text"
                                        (keyup.enter)="searchDatas()"
                                    />
                                </div>
                                <div class="input-search">
                                    <input type="text" placeholder="Issue Date From" [(ngModel)]="issueFromDate"
                                        name="issueFromDate" class="form-control" bsDatepicker #ir="bsDatepicker"
                                        placement="bottom left"
                                        [bsConfig]="{ dateInputFormat: 'DD/MM/YYYY' ,isAnimated: true, selectFromOtherMonth:true, showClearButton: true, showTodayButton: true, todayPosition:'right',     }" />
                                    <i class="fa fa-calendar-alt" (click)="ir.toggle()"></i>
                                </div>
                                <div class="input-search">
                                    <input type="text" placeholder="Issue Date To" [(ngModel)]="issueToDate"
                                        name="issueToDate" class="form-control" bsDatepicker #it="bsDatepicker"
                                        placement="bottom right"
                                        [bsConfig]="{ dateInputFormat: 'DD/MM/YYYY' ,isAnimated: true, selectFromOtherMonth:true, showClearButton: true, showTodayButton: true, todayPosition:'right',     }" />
                                    <i class="fa fa-calendar-alt" (click)="it.toggle()"></i>
                                </div>
                                <div class="input-search">
                                    <input type="text" placeholder="Request Date From" [(ngModel)]="requestFromDate"
                                        name="requestFromDate" class="form-control" bsDatepicker #rr="bsDatepicker"
                                        placement="bottom left"
                                        [bsConfig]="{ dateInputFormat: 'DD/MM/YYYY' ,isAnimated: true, selectFromOtherMonth:true, showClearButton: true, showTodayButton: true, todayPosition:'right',     }" />
                                    <i class="fa fa-calendar-alt" (click)="rr.toggle()"></i>
                                </div>
                                <div class="input-search">
                                    <input type="text" placeholder="Request Date To" [(ngModel)]="requestToDate"
                                        name="requestToDate" class="form-control" bsDatepicker #rt="bsDatepicker"
                                        placement="bottom left"
                                        [bsConfig]="{ dateInputFormat: 'DD/MM/YYYY' ,isAnimated: true, selectFromOtherMonth:true, showClearButton: true, showTodayButton: true, todayPosition:'right',     }" />
                                    <i class="fa fa-calendar-alt" (click)="rt.toggle()"></i>
                                </div>

                                <div class="btn-search">
                                    <button (click)="searchDatas()" class="btn btn-primary" >
                                        <i class="fas fa-search"></i>
                                    </button>
                                </div>
                                <div class="btn-search">
                                    <button (click)="clearTextSearch()" class="btn btn-danger"  >
                                        <i class="fas fa-backspace"></i>
                                    </button>
                                </div>

                                <div class="btn-search minwidth">
                                    <button class="btn btn-primary groupBtn actionButton_w1 requestedBtn"
                                    (click)="searchbyStatus('R')">
                                        <i class="fa-solid fa-user-pen"></i> Requested
                                    </button>
                                </div>
                                <div class="btn-search minwidth">
                                    <button class="btn btn-success groupBtn actionButton_w1 issuedBtn"
                                    (click)="searchbyStatus('I')" >
                                        <i class="fa-solid fa-user-check"></i> Issued
                                    </button>
                                </div>
                                <div class="btn-search minwidth">
                                    <button class="btn btn-info groupBtn actionButton_w1 todayBtn" (click)="searchbyStatus('D')">
                                        <i class="fa-regular fa-calendar-plus"></i> ToDay
                                    </button>
                                </div>
                            </div>
                            <!-- <div class="input-group"> -->


                            <!-- </div> -->
                        </div>
                    </div>
                    <div></div>
                    <div class="ui-g-12 ui-md-12">
                        <div class="ui-g-12">
                            <h6 class="card-header">
                                 {{ l(' Issuing Header ') }}
                            </h6>
                        </div>
                        <!-- <form autocomplete="on">  NGHIÊM CẤM THÊM FROM VÀO GRID-->
                        <div class="panel panel-default pt-1">
                            <grid-table
                                [columnDefs]="listColDefs"
                                [paginationParams]="paginationParams"
                                [rowData]="rowData"
                                [defaultColDef]="defaultColDef"
                                (callBackEvent)="callBackDataGrid($event)"
                                (changePaginationParams)="changePage($event)"
                                (onChangeSelection)="onChangeRowSelection($event)"
                                [rowSelection]="rowSelection"
								[frameworkComponents]="frameworkComponents"
                                [height]="'35vh'"
                            >
                            </grid-table>
                            <!--       [height]="'33vh'"
                                [heightAuto]="false" -->
                        </div>

                        <!-- *ngIf="isGranted('Pages.Master.Common.GradeColor.History')" -->
                        <div class=" panelBtn text-right">
                            <button
                            *ngIf="isGranted('Pages.GPS.Issuings.History')"
                            class="btn btn-warning font-weight-bold"
                            (click)="viewHistoryIssuingsModal.show(selectHeaderId,'H')"  [disabled]="!changedRecordsHeader.includes(selectedRow.id)">
                            <i class="fa-regular fa-eye"></i>{{ l('History') }}
                            </button>
                            <button 
                            class="btn btn-warning font-weight-bold"
                            (click)="viewLoggingResponse()">
                            <i class="fa-regular fa-eye"></i>{{ l('View His Online Budget Check') }}
                            </button>
                            <button
                            class="btn btn-info font-weight-bold"
                            (click)="importInvGpsIssuing.show()"
                            *ngIf="isGranted('Pages.GPS.Issuings.MemberShop')">
                            <i class="fas fa-file-import"></i>{{ l('Import Request') }}
                            </button>
                            <button  class="btn btn-primary font-weight-bold"
                            *ngIf="isGranted('Pages.GPS.Issuings.MemberShop')"
                            (click)="createDocumentIssuing.show()">
                            <i class="fa fa-plus mr-1"></i>{{ l('New Request') }}
                            </button>
                            <button
                                class="btn btn-warning font-weight-bold " (click)="onChangeButton('R')"
                                *ngIf="isGranted('Pages.GPS.Issuings.MemberShop')"
                                [disabled]="selectedRow.status != 'NEW'">
                                <i class="fas fa-paper-plane mr-1"></i>{{ l('Request') }}
                            </button>
                            <button
                                class="btn btn-primary font-weight-bold " (click)="onChangeButton('S')"
                                *ngIf="isGranted('Pages.GPS.Issuings.MemberShop')"
                                [disabled]="selectedRow.status != 'REQUESTED'">
                                <i class="fas fa-paper-plane mr-1"></i>{{ l('Submit') }}
                            </button>
                            <button
                                class="btn btn-success font-weight-bold " (click)="onChangeButton('A')"
                                *ngIf="isGranted('Pages.GPS.Issuings.LeaderShop')"
                                [disabled]="selectedRow.status != 'SUBMITED'">
                                <i class="fas fa-check-circle mr-1"></i>{{ l('Approve') }}
                            </button>
                            <button
                                class="btn  btn-danger font-weight-bold " (click)="onChangeButton('C')"
                                *ngIf="isGranted('Pages.GPS.Issuings.LeaderShop')"
                                [disabled]="selectedRow.status != 'SUBMITED'">
                                <i class="fas fa-trash mr-1"></i>{{ l('Cancel ') }}
                            </button>
                            <button
                                class="btn btn-success font-weight-bold " (click)="onChangeButton('GPSA')"
                                *ngIf="isGranted('Pages.GPS.Issuings.LeaderGps')"
                                [disabled]="selectedRow.status != 'APPROVED'">
                                <i class="fas fa-check-circle mr-1"></i>{{ l('GPS Approve') }}
                            </button>
                            <button
                                class="btn  btn-danger font-weight-bold " (click)="onChangeButton('GPSC')"
                                *ngIf="isGranted('Pages.GPS.Issuings.LeaderGps')"
                                [disabled]="selectedRow.status != 'APPROVED'">
                                <i class="fas fa-trash mr-1"></i>{{ l('GPS Cancel ') }}
                            </button>
                        </div>


                        <div class="ui-g-12 ph-0">
                            <div class="ui-g-12">
                                <h6 class="card-header">
                                     {{ l(' Issuing Details ') }}
                                </h6>
                            </div>
                            <grid-table
                                [columnDefs]="gradeColDefs"
                                [paginationParams]="paginationParamsDetail"
                                [showPagination]="true"
                                [rowData]="rowDataDetails"
                                [defaultColDef]="defaultColDef"
                                [frameworkComponents]="frameworkComponents"
                                (changePaginationParams)="changePageDetails($event)"
                                (onChangeSelection)="onChangeRowSelectionDetails($event)"
                                (callBackEvent)="callBackDataGrid_Details($event)"
                                (cellValueChanged)="onCellValueChangedDetails($event)"
                                [height]="'35vh'"
                               >
                            </grid-table>
                        </div>
                        <hr>
                        <div class="panelBtn text-right"  >
                            <button
                            *ngIf="isGranted('Pages.GPS.Issuings.History')"
                            class="btn btn-warning font-weight-bold"
                            (click)="viewHistoryIssuingsModal.show(selectDetailId,'DT')" [disabled]="!changedRecordsDetail.includes(selectedRowDetail.id)">
                            <i class="fa-regular fa-eye"></i>{{ l('History') }}
                            </button>
                            <button  class="btn btn-primary font-weight-bold"
                                *ngIf="isGranted('Pages.GPS.Issuings.MemberShop')"
                                (click)="createItemIssuing.show(selectedRow)"
                                 [disabled]="!(selectedRow.status == 'NEW')">
                                <i class="fa fa-plus mr-1"></i>{{ l('New Item Request ') }}
                            </button>
                           
                            <button class="btn btn-warning font-weight-bold" [disabled]="checkFun" (click)="viewFundCommitItemDM()">
                                <i class="fa-regular fa-eye"></i>{{ l('View Fund Cmm Selected') }}
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </fieldset>
    </div>
</div>
<create-document-issuings-modal #createDocumentIssuing></create-document-issuings-modal>
<create-item-issuings-modal #createItemIssuing></create-item-issuings-modal>
<import-issuings-modal #importInvGpsIssuing></import-issuings-modal>
<view-fund-commitment-item #viewFundCommitmentItem></view-fund-commitment-item>
<viewLoggingResponseBudgetCheck #viewLoggingResponseBudgetCheck></viewLoggingResponseBudgetCheck>
<history-issuings-modal #viewHistoryIssuingsModal></history-issuings-modal>